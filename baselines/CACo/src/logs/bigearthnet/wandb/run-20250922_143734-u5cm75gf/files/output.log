Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A800-SXM4-80GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Using 26969/269695 training samples (10.0%)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
/hpc2hdd/home/qwang650/anaconda3/envs/caco/lib/python3.10/site-packages/pytorch_lightning/utilities/model_summary/model_summary.py:231: Precision 16-mixed is not supported by the model summary.  Estimated model size in MB will not be accurate. Using 32 bits instead.

   | Name            | Type                | Params | Mode
-----------------------------------------------------------------
0  | backbone        | Sequential          | 23.5 M | train
1  | classifier      | Sequential          | 38.9 K | train
2  | criterion       | BCEWithLogitsLoss   | 0      | train
3  | train_precision | MultilabelPrecision | 0      | train
4  | train_recall    | MultilabelRecall    | 0      | train
5  | train_f1        | MultilabelF1Score   | 0      | train
6  | train_auroc     | MultilabelAUROC     | 0      | train
7  | val_precision   | MultilabelPrecision | 0      | train
8  | val_recall      | MultilabelRecall    | 0      | train
9  | val_f1          | MultilabelF1Score   | 0      | train
10 | val_auroc       | MultilabelAUROC     | 0      | train
-----------------------------------------------------------------
38.9 K    Trainable params
23.5 M    Non-trainable params
23.5 M    Total params
94.188    Total estimated model params size (MB)
163       Modules in train mode
0         Modules in eval mode
Epoch 0:  27%|███████████▍                               | 225/842 [01:53<05:10,  1.99it/s, v_num=75gf, train/loss_step=0.217]
/hpc2hdd/home/qwang650/anaconda3/envs/caco/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/hpc2hdd/home/qwang650/anaconda3/envs/caco/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)

Detected KeyboardInterrupt, attempting graceful shutdown ...
